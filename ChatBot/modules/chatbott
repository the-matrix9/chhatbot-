import asyncio, random
from pyrogram import Client, filters
from pyrogram.types import Message
from ChatBot import app

# --- Extra predefined replies ---
HELLO_REPLIES = ["Hii ğŸ’• kaise ho?", "Heyyy ğŸ˜Š", "Hello ji ğŸ˜", "Hi cutie ğŸ’–"]
OWNER_REPLY = "Mera owner @rishu1286 hai ğŸ’–"
FLIRTY_REPLIES = [
    "Bas tumse baat kar rahi hu â¤ï¸",
    "Tumhe yaad kar rahi thi ğŸ˜˜",
    "Kuch khaas nahi, tum?",
    "Bas relax kar rahi hu, aur tum? ğŸ’•"
]

# --- Extra Handler for Fun Chat ---
@app.on_message(filters.text & ~filters.command(["chatbot"]))
async def sonali_extra(client, message: Message):
    user_id = message.from_user.id

    # Sirf enabled users ke liye
    from main import is_enabled, ask_sonali
    if not is_enabled(user_id):
        return

    text = message.text.lower().strip()

    # Auto Hello response
    if text in ["hi", "hello", "hii", "hey"]:
        await client.send_chat_action(message.chat.id, "typing")
        await asyncio.sleep(1.5)  # typing delay
        await message.reply(random.choice(HELLO_REPLIES))
        return

    # Owner question
    if "owner" in text and ("kaun" in text or "koun" in text):
        await client.send_chat_action(message.chat.id, "typing")
        await asyncio.sleep(1.5)
        await message.reply(OWNER_REPLY)
        return

    # Flirty reply
    if "kya kar rahi ho" in text or "kya kr rhi ho" in text:
        await client.send_chat_action(message.chat.id, "typing")
        await asyncio.sleep(2)
        await message.reply(random.choice(FLIRTY_REPLIES))
        return

    # Normal Together API reply (fallback)
    await client.send_chat_action(message.chat.id, "typing")
    await asyncio.sleep(1.5)
    reply = ask_sonali(message.text)
    await message.reply(reply)
